# ============================================================================
# SK Attendance LTI Tool - Environment Configuration Template
# ============================================================================
# 
# INSTRUCTIONS:
# 1. Copy this file to .env in the project root
# 2. Replace all placeholder values (marked with CHANGE_ME_*)
# 3. Never commit .env to version control!
# 4. Keep .env file permissions restricted (chmod 600 .env)
#
# For production deployment, see: DEPLOYMENT.md
# For detailed configuration guide, see: README.md
#
# ============================================================================

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# Port the application listens on
# Default: 3001
# Change only if port 3001 is already in use
PORT=3001

# Node environment
# Values: development | production | test
# Production enables optimizations and disables debug features
NODE_ENV=development

# Public URL where the application is accessible
# CRITICAL: This MUST match your Canvas Developer Key URLs
# IMPORTANT: No trailing slash!
# Development example: https://your-tunnel-url.trycloudflare.com
# Production example: https://attendance.yourdomain.com
PUBLIC_URL=CHANGE_ME_YOUR_PUBLIC_URL

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL connection settings
# Ensure PostgreSQL is installed and running
DB_HOST=localhost
DB_PORT=5432
DB_NAME=attendance
DB_USER=attendance_user
DB_PASSWORD=CHANGE_ME_STRONG_DATABASE_PASSWORD

# Database connection pool settings (optional, defaults shown)
# DB_POOL_MAX=20                    # Maximum number of connections
# DB_POOL_IDLE_TIMEOUT=30000        # Close idle connections after 30s
# DB_POOL_CONNECTION_TIMEOUT=2000   # Connection timeout in ms

# ============================================================================
# CANVAS API INTEGRATION
# ============================================================================

# Canvas API Access Token
# Required for automatic enrollment synchronization
# How to generate:
# 1. Canvas → Account Settings → Approved Integrations
# 2. + Access Token
# 3. Purpose: "SK Attendance - Enrollment Sync"
# 4. Copy token here
CANVAS_API_TOKEN=CHANGE_ME_CANVAS_ADMIN_API_TOKEN

# Canvas instance base URL
# This is YOUR Canvas URL (where you login)
# IMPORTANT: No trailing slash!
# Example: https://canvas.example.edu
# Example: https://yourschool.instructure.com
CANVAS_BASE_URL=CHANGE_ME_YOUR_CANVAS_INSTANCE_URL

# ============================================================================
# CANVAS LTI 1.3 CONFIGURATION
# ============================================================================

# Canvas Platform URL (OAuth issuer)
# For cloud-hosted Canvas, this is ALWAYS:
CANVAS_PLATFORM_URL=https://canvas.instructure.com

# For self-hosted Canvas, use your Canvas URL:
# CANVAS_PLATFORM_URL=https://your-canvas-instance.edu

# Canvas Developer Key Client ID
# Found in: Canvas → Admin → Developer Keys
# After creating LTI Key, copy the "Client ID" (looks like: 289220000000000001)
CANVAS_CLIENT_ID=CHANGE_ME_DEVELOPER_KEY_CLIENT_ID

# Canvas Deployment ID
# Format: {tool_id}:{hash}
# Example: 250:b94315135ba58f44565b44c96982e84f425fcfd8
# This is automatically generated when you install the tool
# You may need to inspect the LTI launch POST data to find this
CANVAS_DEPLOYMENT_ID=CHANGE_ME_DEPLOYMENT_ID

# Canvas JWKS URL (public keys for JWT verification)
# For cloud-hosted Canvas, use:
CANVAS_JWKS_URL=https://canvas.instructure.com/api/lti/security/jwks

# For self-hosted Canvas, use:
# CANVAS_JWKS_URL=https://your-canvas-instance.edu/api/lti/security/jwks

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================

# Session secret for signing cookies
# CRITICAL: Generate a strong random string (at least 32 characters)
# Never use the example value in production!
# Generate with: openssl rand -hex 32
# Or: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SESSION_SECRET=CHANGE_ME_RANDOM_64_CHARACTER_STRING_HERE

# Session cookie settings (optional, defaults shown)
# SESSION_COOKIE_SECURE=false       # Set to true in production with HTTPS
# SESSION_COOKIE_MAX_AGE=86400000   # 24 hours in milliseconds
# SESSION_COOKIE_SAME_SITE=none     # Required for LTI iframe (none | lax | strict)
# SESSION_COOKIE_HTTP_ONLY=true     # Prevent JavaScript access to cookies

# Session store type (optional)
# Values: postgres | redis | memory
# Default: postgres (recommended for production)
# SESSION_STORE=postgres

# Redis session store (only if SESSION_STORE=redis)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# ============================================================================
# FILE UPLOAD CONFIGURATION
# ============================================================================

# Maximum file size for excuse uploads (in bytes)
# Default: 5242880 (5 MB)
# Recommended: 5-10 MB (balance between usability and storage)
MAX_FILE_SIZE=5242880

# Allowed file types for excuse uploads (comma-separated MIME types)
# Default: PDF, JPEG, PNG
# ALLOWED_FILE_TYPES=application/pdf,image/jpeg,image/png

# Upload directory (relative to project root)
# Default: uploads/
# Ensure this directory exists and is writable
# UPLOAD_DIR=uploads

# ============================================================================
# EMAIL NOTIFICATIONS (OPTIONAL)
# ============================================================================

# Enable/disable email notifications
# Values: true | false
# Default: false (notifications disabled)
ENABLE_EMAIL_NOTIFICATIONS=false

# Email service provider
# Options: sendgrid | mailgun | ses | smtp
# EMAIL_PROVIDER=sendgrid

# SendGrid configuration (if EMAIL_PROVIDER=sendgrid)
# Get API key: https://app.sendgrid.com/settings/api_keys
# SENDGRID_API_KEY=CHANGE_ME_SENDGRID_API_KEY

# Mailgun configuration (if EMAIL_PROVIDER=mailgun)
# Get API key: https://app.mailgun.com/app/account/security/api_keys
# MAILGUN_API_KEY=CHANGE_ME_MAILGUN_API_KEY
# MAILGUN_DOMAIN=CHANGE_ME_YOUR_DOMAIN

# AWS SES configuration (if EMAIL_PROVIDER=ses)
# AWS_ACCESS_KEY_ID=CHANGE_ME_AWS_ACCESS_KEY
# AWS_SECRET_ACCESS_KEY=CHANGE_ME_AWS_SECRET_KEY
# AWS_REGION=eu-central-1

# SMTP configuration (if EMAIL_PROVIDER=smtp)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_SECURE=false                 # true for 465, false for 587
# SMTP_USER=CHANGE_ME_SMTP_USERNAME
# SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD

# Email sender address
# This is the "From" address for all emails
# Must be verified with your email provider
# EMAIL_FROM=attendance@yourdomain.com
# EMAIL_FROM_NAME=SK Attendance System

# ============================================================================
# QR CODE CONFIGURATION
# ============================================================================

# QR code default validity period (in minutes)
# Default: 15 minutes
# Recommended: 10-30 minutes (balance between convenience and security)
QR_CODE_VALIDITY_MINUTES=15

# QR code image size (in pixels)
# Default: 400
# Recommended: 300-600 (smaller = faster generation, larger = easier scanning)
# QR_CODE_SIZE=400

# QR code error correction level
# Values: L | M | Q | H (Low, Medium, Quartile, High)
# Default: M (15% error correction)
# Higher = more robust but larger image
# QR_CODE_ERROR_CORRECTION=M

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level
# Values: error | warn | info | debug
# Default: info
# Production recommendation: warn (reduces log volume)
LOG_LEVEL=info

# Log format
# Values: json | pretty
# Default: pretty (human-readable)
# Production recommendation: json (machine-parseable)
# LOG_FORMAT=pretty

# Log to file (optional)
# ENABLE_FILE_LOGGING=false
# LOG_FILE_PATH=./logs/app.log
# LOG_FILE_MAX_SIZE=10485760        # 10 MB
# LOG_FILE_MAX_FILES=5              # Keep 5 rotated logs

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================

# Rate limiting (requests per window)
# Default: 100 requests per 15 minutes per IP
# Adjust based on expected usage
# RATE_LIMIT_WINDOW_MS=900000       # 15 minutes
# RATE_LIMIT_MAX_REQUESTS=100

# Check-in rate limiting (stricter)
# Default: 5 check-ins per minute per IP
# Prevents QR code abuse
# CHECKIN_RATE_LIMIT_WINDOW_MS=60000
# CHECKIN_RATE_LIMIT_MAX_REQUESTS=5

# Enable CORS (Cross-Origin Resource Sharing)
# Default: false (only allow same-origin)
# Only enable if you need cross-origin API access
# ENABLE_CORS=false

# Allowed CORS origins (comma-separated)
# Only used if ENABLE_CORS=true
# CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# Enable audit logging
# Default: false
# Logs all important actions to database for compliance
# ENABLE_AUDIT_LOGGING=false

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable specific features
# Useful for gradual rollout or A/B testing

# Enable Canvas enrollment auto-sync
# Default: true
# When QR code is generated, automatically sync student list from Canvas
ENABLE_ENROLLMENT_SYNC=true

# Enable excuse file uploads
# Default: true
# ENABLE_EXCUSE_UPLOADS=true

# Enable BAföG PDF generation
# Default: true
# ENABLE_BAFOEG_PDF=true

# Enable Excel/CSV exports
# Default: true
# ENABLE_EXPORTS=true

# Enable course overview matrix
# Default: true
# ENABLE_COURSE_OVERVIEW=true

# ============================================================================
# PERFORMANCE & CACHING
# ============================================================================

# Enable Redis caching (requires Redis server)
# Default: false
# Significantly improves performance for large courses
# ENABLE_REDIS_CACHE=false

# Redis cache connection (only if ENABLE_REDIS_CACHE=true)
# REDIS_CACHE_HOST=localhost
# REDIS_CACHE_PORT=6379
# REDIS_CACHE_PASSWORD=
# REDIS_CACHE_DB=1                  # Use different DB than session store

# Cache TTL (time-to-live) in seconds
# CACHE_TTL_COURSES=3600            # Course info: 1 hour
# CACHE_TTL_SESSIONS=300            # Sessions list: 5 minutes
# CACHE_TTL_STUDENTS=900            # Student list: 15 minutes

# ============================================================================
# INTERNATIONALIZATION (I18N)
# ============================================================================

# Default language
# Values: de | en
# Default: de (German)
# Future versions will support multiple languages
DEFAULT_LANGUAGE=de

# Available languages (comma-separated)
# AVAILABLE_LANGUAGES=de,en

# ============================================================================
# DEVELOPMENT / DEBUG SETTINGS
# ============================================================================

# Enable debug mode (verbose logging)
# Default: false
# ONLY use in development, never in production!
# DEBUG=false

# Mock Canvas API (for development without Canvas access)
# Default: false
# MOCK_CANVAS_API=false

# Bypass LTI authentication (for local testing)
# Default: false
# WARNING: NEVER enable in production!
# BYPASS_LTI_AUTH=false

# Print SQL queries to console
# Default: false
# Useful for debugging database issues
# LOG_SQL_QUERIES=false

# ============================================================================
# MONITORING & ANALYTICS (OPTIONAL)
# ============================================================================

# Sentry error tracking
# Get DSN: https://sentry.io/
# SENTRY_DSN=CHANGE_ME_SENTRY_DSN
# SENTRY_ENVIRONMENT=production
# SENTRY_SAMPLE_RATE=1.0            # 1.0 = 100% of errors reported

# Google Analytics
# GA_TRACKING_ID=CHANGE_ME_GA_TRACKING_ID

# New Relic APM
# NEW_RELIC_LICENSE_KEY=CHANGE_ME_NEW_RELIC_KEY
# NEW_RELIC_APP_NAME=SK Attendance LTI

# ============================================================================
# BACKUP & MAINTENANCE
# ============================================================================

# Automatic database backup
# ENABLE_AUTO_BACKUP=false
# BACKUP_SCHEDULE=0 2 * * *         # Cron format: Daily at 2 AM
# BACKUP_RETENTION_DAYS=30          # Delete backups older than 30 days
# BACKUP_DIR=/path/to/backups

# Maintenance mode
# When enabled, shows "Under Maintenance" page to all users
# MAINTENANCE_MODE=false
# MAINTENANCE_MESSAGE=System wird gewartet. Bitte versuchen Sie es später erneut.

# ============================================================================
# TIMEZONE
# ============================================================================

# Application timezone
# Default: Europe/Berlin
# Format: IANA timezone identifier
# List: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
TZ=Europe/Berlin

# ============================================================================
# CUSTOM BRANDING (OPTIONAL)
# ============================================================================

# Organization name
# Default: SK (Süddeutsche Karriere)
# ORG_NAME=Your Organization Name

# Primary brand color (hex code)
# BRAND_COLOR_PRIMARY=#6366f1

# Logo URL (optional)
# LOGO_URL=https://yourdomain.com/logo.png

# Support email
# SUPPORT_EMAIL=support@yourdomain.com

# Support URL
# SUPPORT_URL=https://support.yourdomain.com

# ============================================================================
# ADVANCED SETTINGS (DO NOT CHANGE UNLESS YOU KNOW WHAT YOU'RE DOING)
# ============================================================================

# LTI tool version
# LTI_VERSION=1.3

# JWT algorithm
# JWT_ALGORITHM=RS256

# RSA key size for LTI
# RSA_KEY_SIZE=2048

# Session table name
# SESSION_TABLE_NAME=session

# Database SSL mode
# Values: disable | require | verify-ca | verify-full
# DB_SSL_MODE=disable

# ============================================================================
# END OF CONFIGURATION
# ============================================================================

# Questions or issues?
# - Documentation: See README.md, ARCHITECTURE.md, DEPLOYMENT.md
# - GitHub Issues: https://github.com/umkaru/sk-attendance-lti/issues
# - Email: neumannsrb@gmail.com
